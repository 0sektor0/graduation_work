%Xj = [4.9, 5.0, 6.5, 10.9, 11.0, 11.4, 12.7, 13.1, 14.0, 14.5];
%Xj = randn(1, 500);
%Xj = randn(1, 50);
Xj = [1.43704449250503, -2.25107830229662, 0.356489129614670, -0.850241546233911, -0.299551039013598, -0.634248593240228, 1.62447736292239, 1.24107013210744, 0.555280542465301, 0.703417615515007, 0.458163339087800, 0.683983990193095, 0.251289579561714, -0.178503895299454, 0.507725830227577, -0.309899118172596, -0.394370246114765, -0.269738542331054, -0.0881301721574661, 0.00802927442394316, 2.53179561500313, -1.22324305766679, -1.07175060654708, 0.246058645413183, -0.0506114772978772, -0.730150625300169, 0.326987125798262, 0.752990913282200, -1.15372154650913, -0.407867049778377, -1.28790643118115, 0.0835776870827117, 0.163799300505320, 0.682574713533531, -1.08636761523444, 0.297492378480315, -0.143308255589629, 1.39195366021220, 0.306747373328607, -0.537184201783269, -0.228932242650808, -0.536220402360493, 1.43902127211766, -0.511099687964879, -1.60683544726011, -0.201243021960019, 1.14350341027786, 0.663291080888331, 0.164084365770933, 1.78540550916262];

[Xucl, Xcl, Xlcl, Rucl, Rcl, Rlcl] = ShewhartInd(Xj);
%[Xucl, Xcl, Xlcl, Rucl, Rcl, Rlcl] = ShewhartIndP(0.6, 0.3);

n = length(Xj);
YR = abs(Xj(1:n-1) - Xj(2:n));
YRcl = Rcl*ones(1, n-1);
YRucl = Rucl*ones(1, n-1);
YRlcl = Rlcl*ones(1, n-1);

YXcl = Xcl*ones(1, n);
YXucl = Xucl*ones(1, n);
YXlcl = Xlcl*ones(1, n);

XR = 1 : 1 : n-1;
XX = 1 : 1 : n;

subplot(2,1,1);
%R карта
plot(XR, YR, XR, YRucl, XR, YRcl, XR, YRlcl);


%X карта и линии
sigm = (Xucl - Xlcl)/6;
lA = Xlcl + sigm;
lB = Xlcl + 2*sigm;
lC = Xcl;
uC = Xlcl + 4*sigm;
uB = Xlcl + 5*sigm;
uA = Xucl;

lAY = lA * ones(1, n);
lBY = lB * ones(1, n);
lCY = lC * ones(1, n);
uAY = uA * ones(1, n);
uBY = uB * ones(1, n);
uCY = uC * ones(1, n);

subplot(2,1,2);
%X карта
%plot(XX, Xj, XX, YXucl, XX, YXcl, XX, YXlcl);
plot(XX, Xj, XX, YXucl, XX, YXcl, XX, YXlcl, XX, lAY, XX, lBY, XX, uCY, XX, uBY);

for i=1:8
    i = i
    [is_uc, num] = Check4SpecialResons(Xj, [i], Xlcl, lA, lB, lC, uC, uB, uA)
end



















